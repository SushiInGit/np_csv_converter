<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>


    <!--  Settings - Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <h2>Settings</h2>
            <div id="timezoneDiv">
                <label for="timezone">Timezone:</label>
                <select id="timezone">
                    <option value="UTC">UTC</option>
                    <option value="Europe/Berlin">Europe/Berlin (CEST)</option>
                    <option value="America/New_York">America/New_York (EDT)</option>
                    <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
                    <option value="Australia/Sydney">Australia/Sydney (AEST/AEDT)</option>
                    <option value="America/Los_Angeles">America/Los_Angeles (PST/PDT)</option>
                    <option value="Europe/London">Europe/London (BST)</option>
                    <option value="Asia/Kolkata">Asia/Kolkata (IST)</option>
                    <option value="Africa/Johannesburg">Africa/Johannesburg (SAST)</option>
                </select>
            </div>
            <div id="dateformatDiv">
                <label for="dateformat">Dateformat:</label>
                <select id="dateformat">
                    <option value="en-US">MM/DD/YYYY</option>
                    <option value="en-GB">DD/MM/YYYY</option>
                    <option value="de-DE">DD.MM.YYYY</option>
                    <option value="ja-JP">YYYY-MM-DD</option>
                </select>
            </div>
            <div id="use12hClockDiv">
                <label for="use12hClock">12h clock</label>
                <input type="checkbox" id="use12hClock" />
            </div>
            <div id="timeFirstDiv">
                <label for="timeFirst">Time first</label>
                <input type="checkbox" id="timeFirst" />
            </div>
            <div id="timezoneOffsetDiv">
                <label for="timezoneOffset">Timezone offset</label>
                <input type="number" id="timezoneOffset" min="-12" max="12" step="1" value="0">
            </div>
            <div id="showUTCDiv">
                <label for="showUTC">Show UTC next to formatted time</label>
                <input type="checkbox" id="showUTC" />
            </div>
            <br />
            <button id="saveSettings" onchange="resetTable()">Save</button>
            <button id="closeSettings" onchange="resetTable()">Close</button>
        </div>
    </div>

    <!-- File Upload Modal -->
    <div class="modal" id="fileUploadModal">
        <div class="modal-content" id="modalcontent">
            <h2>File upload</h2>
            <div id="dropZone">Drag & Drop or click to Upload a Excel-File.</div>
            <div id="dropZoneError">An error occurred during the file upload. Please try again or upload a valid file. If the problem persists, contact support.</div>
            <input type="file" id="fileInput" style="display: none;">
            <button id="closeFileUpload">Close</button>
        </div>
    </div>

    <!-- Search Box-->
    <div class="head-container">
        <div class="search-container">
            <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Search...">
            <label class="upload-button" id="fileUploadPopup" onchange="resetTable()">
                <svg fill="#000000" height="15px" width="15px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                    viewBox="0 0 490.955 490.955" xml:space="preserve">
                <path id="XMLID_448_" d="M445.767,308.42l-53.374-76.49v-20.656v-11.366V97.241c0-6.669-2.604-12.94-7.318-17.645L312.787,7.301
                    C308.073,2.588,301.796,0,295.149,0H77.597C54.161,0,35.103,19.066,35.103,42.494V425.68c0,23.427,19.059,42.494,42.494,42.494
                    h159.307h39.714c1.902,2.54,3.915,5,6.232,7.205c10.033,9.593,23.547,15.576,38.501,15.576c26.935,0-1.247,0,34.363,0
                    c14.936,0,28.483-5.982,38.517-15.576c11.693-11.159,17.348-25.825,17.348-40.29v-40.06c16.216-3.418,30.114-13.866,37.91-28.811
                    C459.151,347.704,457.731,325.554,445.767,308.42z M170.095,414.872H87.422V53.302h175.681v46.752
                    c0,16.655,13.547,30.209,30.209,30.209h46.76v66.377h-0.255v0.039c-17.685-0.415-35.529,7.285-46.934,23.46l-61.586,88.28
                    c-11.965,17.134-13.387,39.284-3.722,57.799c7.795,14.945,21.692,25.393,37.91,28.811v19.842h-10.29H170.095z M410.316,345.771
                    c-2.03,3.866-5.99,6.271-10.337,6.271h-0.016h-32.575v83.048c0,6.437-5.239,11.662-11.659,11.662h-0.017H321.35h-0.017
                    c-6.423,0-11.662-5.225-11.662-11.662v-83.048h-32.574h-0.016c-4.346,0-8.308-2.405-10.336-6.271
                    c-2.012-3.866-1.725-8.49,0.783-12.07l61.424-88.064c2.189-3.123,5.769-4.984,9.57-4.984h0.017c3.802,0,7.38,1.861,9.568,4.984
                    l61.427,88.064C412.04,337.28,412.328,341.905,410.316,345.771z"/>
                </svg>
            </label>
            <input type="file" id="file-upload">
            <button class="settings-button" id="settingsPopup" onchange="resetTable()">
                <svg fill="#000000" height="15px" width="15px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 491.556 491.556" xml:space="preserve">
                <path id="XMLID_680_" d="M480.537,132.385c-6.372-2.813-13.814-1.418-18.729,3.502l-49.891,49.868l-91.012-16.093l-16.101-91.018
                    l49.894-49.867c4.911-4.921,6.307-12.356,3.5-18.728c-2.805-6.364-9.258-10.36-16.197-10.029
                    C308,1.608,274.485,15.334,248.51,41.316c-39.887,39.872-50.913,97.498-33.435,147.364L19.369,384.429
                    c-24.516,24.5-24.516,64.24,0,88.749c11.756,11.764,27.712,18.378,44.363,18.378c16.635,0,32.605-6.615,44.361-18.37l196.679-196.68
                    c49.196,16.044,105.395,4.654,144.471-34.447c25.976-25.968,39.708-59.475,41.314-93.468
                    C490.864,141.644,486.909,135.206,480.537,132.385z M94.214,435.747c-10.328,10.329-27.094,10.329-37.422,0
                    c-10.346-10.344-10.346-27.094,0-37.439c10.328-10.327,27.094-10.327,37.422,0C104.544,408.653,104.544,425.402,94.214,435.747z"/>
            </svg>
            </button>
            <span class="search_icon">
                <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
            </span>
        </div>
    </div>

    <!-- Content Output -->
        <div class="content">
            <div id="welcomeDiv" class="welcomeDiv">
                <center><h2>Welcome!</h2>
                To get the most out of this website, please upload a CSV or Excel file. Once the file is uploaded, youâ€™ll unlock full access to all the features and tools available.<br />                
                Simply click the upload button to get started.<br />
                <br />
                If you encounter any issues during the upload process, feel free to reach out for support.</center>
            </div>
            <div class="headTable" id="headTable">
                <div class="headTablesheet">
                    <label for="sheet">Sheet</label>
                    <input type="number" id="sheet" min="1" step="1" value="1">
                </div>
                <div class="headTablecopybtn">
                    <button id="copyTable">Copy table (enables copy paste to excel)</button>
                </div>
            </div>
        <!-- Table Display-->
        <table id="phoneRecords"></table>

        <!-- Footer-->
        <footer><p>Project located on <a href="https://github.com/SushiInGit/np_csv_converter/">GitHub</a></p></footer><br />
    </div>
    
    <!-- ajax and render scripts-->
    <script src="script/script.js"></script>
    <script src="script/settings.js"></script>
    <script src="script/fileupload.js"></script>
    <script src="script/search.js"></script>
</body>

</html>
